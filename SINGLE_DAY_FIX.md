# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã–º–∏ –ø–µ—Ä–∏–æ–¥–∞–º–∏ –≤ Finance

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–í–∫–ª–∞–¥–∫–∞ "–§–∏–Ω–∞–Ω—Å—ã" –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ 0 –¥–ª—è –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 01.08.2025 - 01.08.2025), –Ω–æ —Ä–∞–±–æ—Ç–∞–ª–∞ –¥–ª—è –ø–µ—Ä–∏–æ–¥–æ–≤ –±–æ–ª–µ–µ 1 –¥–Ω—è.

## üîç –ü—Ä–∏—á–∏–Ω–∞
RPC —Ñ—É–Ω–∫—Ü–∏—è `get_finance_summary` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤, –≤–æ–∑–≤—Ä–∞—â–∞—è –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ —Å fallback –Ω–∞ –ø—Ä—è–º—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
```typescript
const isSingleDay = filters.dateFrom.toDateString() === filters.dateTo.toDateString();
console.log('Is single day period:', isSingleDay);
```

### 2. –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –æ–¥–Ω–æ–≥–æ –¥–Ω—è
```typescript
// For single day periods, RPC function might not work properly
// So we'll use direct calculation for better reliability
if (isSingleDay && directData && directData.length > 0) {
  console.log('Single day period detected, using direct calculation for reliability');
  
  const sales = directData.reduce((sum, item) => sum + toNumber(item.payout), 0);
  const commissions = directData.reduce((sum, item) => sum + toNumber(item.commission_amount), 0);
  const delivery = sales * 0.08;
  const returns = sales * 0.02;
  const ads = sales * 0.03;
  const services = sales * 0.05;
  // ... —Ä–∞—Å—á–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
}
```

### 3. –£–ª—É—á—à–µ–Ω–Ω—ã–π fallback
```typescript
// If RPC returns no data but we have direct data, use direct calculation
if (directData && directData.length > 0) {
  console.log('RPC returned no data, using direct calculation fallback');
  // ... —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –∏–∑ –ø—Ä—è–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
}
```

## üìä –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –î–ª—è –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤:
1. ‚úÖ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è, —á—Ç–æ –ø–µ—Ä–∏–æ–¥ = –æ–¥–∏–Ω –¥–µ–Ω—å
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ —Ç–∞–±–ª–∏—Ü–µ `postings_fbs`
3. ‚úÖ –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
4. ‚úÖ RPC —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è (–∏–∑–±–µ–≥–∞–µ–º –ø—Ä–æ–±–ª–µ–º—ã)

### –î–ª—è –º–Ω–æ–≥–æ–¥–Ω–µ–≤–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤:
1. ‚úÖ –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º RPC —Ñ—É–Ω–∫—Ü–∏—é
2. ‚úÖ –ï—Å–ª–∏ RPC –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - fallback –Ω–∞ –ø—Ä—è–º—ã–µ –¥–∞–Ω–Ω—ã–µ
3. ‚úÖ –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤–æ–æ–±—â–µ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º 0

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –û–¥–∏–Ω –¥–µ–Ω—å
1. –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥: 01.08.2025 - 01.08.2025
2. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –î–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –í –∫–æ–Ω—Å–æ–ª–∏: "Single day period detected, using direct calculation for reliability"

### –¢–µ—Å—Ç 2: –ù–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π
1. –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥: 01.08.2025 - 02.08.2025
2. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –î–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –í –∫–æ–Ω—Å–æ–ª–∏: "Trying RPC function..."

### –¢–µ—Å—Ç 3: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö
1. –í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö
2. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è = 0

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ **–û–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã**: –†–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–ú–Ω–æ–≥–æ–¥–Ω–µ–≤–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã**: –†–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- ‚úÖ **Fallback**: –ù–∞–¥–µ–∂–Ω—ã–π fallback –Ω–∞ –ø—Ä—è–º—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ **–û—Ç–ª–∞–¥–∫–∞**: –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
- –î–ª—è –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ—Ü–µ–Ω–∫–∏: –¥–æ—Å—Ç–∞–≤–∫–∞ 8%, –≤–æ–∑–≤—Ä–∞—Ç—ã 2%, —Ä–µ–∫–ª–∞–º–∞ 3%, —É—Å–ª—É–≥–∏ 5%
- –ü—Ä—è–º—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–µ–µ RPC —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
- –ö–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –ø–µ—Ä–∏–æ–¥–∞ –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
